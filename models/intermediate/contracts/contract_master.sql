-- will need to pull in job master to get all contract <> Job joins (~2)

select 
    JCCO, 
    CONTRACT,
    CONTRACT AS JOB,
    DESCRIPTION,
    DEPARTMENT, 
    CONTRACTSTATUS AS CONTRACT_STATUS,
    STARTMONTH AS START_MONTH,
    COALESCE(UDOWNERCONTRACTDATE, STARTDATE, STARTMONTH) AS START_DATE,
    MONTHCLOSED AS MONTH_CLOSED,
    PROJCLOSEDATE AS PROJ_CLOSE_DATE,
    ACTUALCLOSEDATE AS ACTUAL_CLOSE_DATE,
    CUSTGROUP AS CUST_GROUP,
    CUSTOMER,
    PAYTERMS AS PAY_TERMS,
    ORIGCONTRACTAMT AS ORIG_CONTRACT_AMT,
    CONTRACTAMT AS CONTRACT_AMT,
    BILLEDAMT AS BILLED_AMT,
    RECEIVEDAMT AS RECEIVED_AMT,
    CURRENTRETAINAMT AS CURRENT_RETAIN_AMT
from {{ source('shookdw', 'jccm') }}
